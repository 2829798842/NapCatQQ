(function(_0x4bda99,_0x35dcdf){const _0x1fe726=_0x4acc,_0x5be7cd=_0x4bda99();while(!![]){try{const _0x32547a=-parseInt(_0x1fe726(0x199))/0x1*(parseInt(_0x1fe726(0x1d3))/0x2)+parseInt(_0x1fe726(0x1b9))/0x3*(-parseInt(_0x1fe726(0x1a5))/0x4)+-parseInt(_0x1fe726(0x1c3))/0x5*(parseInt(_0x1fe726(0x1d4))/0x6)+parseInt(_0x1fe726(0x1ca))/0x7*(parseInt(_0x1fe726(0x196))/0x8)+parseInt(_0x1fe726(0x1ce))/0x9*(parseInt(_0x1fe726(0x194))/0xa)+-parseInt(_0x1fe726(0x1c2))/0xb+parseInt(_0x1fe726(0x19d))/0xc;if(_0x32547a===_0x35dcdf)break;else _0x5be7cd['push'](_0x5be7cd['shift']());}catch(_0x3a0755){_0x5be7cd['push'](_0x5be7cd['shift']());}}}(_0x1fc1,0xca94b));import{logDebug}from'@/common/utils/log';import{NTQQUserApi}from'./user';import{selfInfo}from'../data';import{RequestUtil}from'@/common/utils/request';function _0x4acc(_0x359701,_0x49d2ca){const _0x1fc175=_0x1fc1();return _0x4acc=function(_0x4acc90,_0x2d69b6){_0x4acc90=_0x4acc90-0x181;let _0x55efcd=_0x1fc175[_0x4acc90];return _0x55efcd;},_0x4acc(_0x359701,_0x49d2ca);}import{WebApi}from'./webapi';import{checkFileReceived2,uri2local}from'@/common/utils/file';import _0xd07c0c from'node:fs';export async function SignMiniApp(_0x1cb796){const _0x4701d0=_0x4acc,_0x8f9ce={'BLtQk':_0x4701d0(0x1c4),'wWgMT':_0x4701d0(0x1cb),'XTCRY':_0x4701d0(0x195),'XttqN':_0x4701d0(0x1c5),'JYwVP':function(_0x31ce35,_0x7a1efb){return _0x31ce35+_0x7a1efb;},'cxsUU':function(_0x2a2af4,_0x506c8a){return _0x2a2af4+_0x506c8a;},'oYQyf':function(_0x144250,_0x23e3c9){return _0x144250+_0x23e3c9;},'dKIdp':_0x4701d0(0x188),'lUSgR':_0x4701d0(0x1b0),'AKHKR':function(_0x252130,_0x39e1fc){return _0x252130+_0x39e1fc;},'IhwiP':function(_0x5b95e6,_0x1f5694){return _0x5b95e6+_0x1f5694;},'ricFf':_0x4701d0(0x1a4),'abhUJ':function(_0x1c71b8,_0x4f3943){return _0x1c71b8(_0x4f3943);},'wqgKi':_0x4701d0(0x1d2),'BINBN':function(_0x34dba1,_0x255029,_0x202db6){return _0x34dba1(_0x255029,_0x202db6);},'ukKMk':'MiniApp\x20JSON\x20消息生成失败'};let _0x585930={'app':_0x8f9ce[_0x4701d0(0x1aa)],'bizsrc':'tianxuan.imgJumpArk','view':_0x8f9ce['wWgMT'],'prompt':_0x1cb796[_0x4701d0(0x1a9)],'config':{'type':_0x8f9ce[_0x4701d0(0x1bf)],'forward':0x1,'autosize':0x0},'meta':{'miniapp':{'title':_0x1cb796[_0x4701d0(0x1a7)],'preview':_0x1cb796[_0x4701d0(0x1c7)][_0x4701d0(0x1cd)](/\\/g,_0x4701d0(0x1c5)),'jumpUrl':_0x1cb796[_0x4701d0(0x190)]['replace'](/\\/g,_0x8f9ce[_0x4701d0(0x1d5)]),'tag':_0x1cb796[_0x4701d0(0x181)],'tagIcon':_0x1cb796['tagIcon'][_0x4701d0(0x1cd)](/\\/g,_0x8f9ce[_0x4701d0(0x1d5)]),'source':_0x1cb796[_0x4701d0(0x1bb)],'sourcelogo':_0x1cb796['sourcelogo'][_0x4701d0(0x1cd)](/\\/g,_0x8f9ce['XttqN'])}}},_0x3b70bf=await NTQQUserApi['getQzoneCookies']();const _0x40a5c8=WebApi['genBkn'](_0x3b70bf['p_skey']),_0x3979fd=_0x8f9ce[_0x4701d0(0x1c0)](_0x8f9ce[_0x4701d0(0x1c0)](_0x8f9ce[_0x4701d0(0x1c0)](_0x8f9ce['JYwVP'](_0x8f9ce[_0x4701d0(0x1c0)](_0x8f9ce['cxsUU'](_0x8f9ce['oYQyf'](_0x4701d0(0x18d),_0x3b70bf[_0x4701d0(0x1d8)]),_0x8f9ce[_0x4701d0(0x1d1)]),_0x3b70bf[_0x4701d0(0x1ba)]),_0x8f9ce['lUSgR']),selfInfo['uin']),_0x4701d0(0x189)),selfInfo[_0x4701d0(0x1d7)]);let _0x40d230=_0x8f9ce[_0x4701d0(0x185)](_0x8f9ce[_0x4701d0(0x1c0)](_0x8f9ce['IhwiP'](_0x4701d0(0x1b8),_0x40a5c8),_0x8f9ce[_0x4701d0(0x18c)]),_0x8f9ce[_0x4701d0(0x183)](encodeURIComponent,JSON[_0x4701d0(0x1ab)](_0x585930))),_0x118610='';try{let _0x564241=await RequestUtil['HttpGetJson'](_0x40d230,_0x8f9ce[_0x4701d0(0x1af)],undefined,{'Cookie':_0x3979fd});_0x118610=_0x564241[_0x4701d0(0x18b)][_0x4701d0(0x1a8)];}catch(_0x28fbc1){_0x8f9ce[_0x4701d0(0x197)](logDebug,_0x8f9ce[_0x4701d0(0x1c6)],_0x28fbc1);}return _0x118610;}export async function SignMusicInternal(_0xf05a7f,_0x3aee90,_0x20461c,_0x379c64,_0x22132a){const _0x17c864=_0x4acc,_0x47337d={'CbTRl':_0x17c864(0x1d0),'BriQO':_0x17c864(0x1bd),'HdtBE':'normal','VHmQl':function(_0x3cc7d4,_0x3d445b){return _0x3cc7d4+_0x3d445b;},'LAjrs':_0x17c864(0x186),'oCxIo':_0x17c864(0x1b6),'DUYcp':_0x17c864(0x1bc),'FMjsB':_0x17c864(0x1b1),'JAyPV':_0x17c864(0x19b),'uigGa':_0x17c864(0x1ad),'qtwcC':_0x17c864(0x18e)};let _0x5b4a5e=_0x17c864(0x1a1),_0x53fd9f={'app':_0x47337d[_0x17c864(0x1a3)],'config':{'ctime':0x6670467e,'forward':0x1,'token':_0x47337d[_0x17c864(0x19c)],'type':_0x47337d[_0x17c864(0x1b4)]},'extra':{'app_type':0x1,'appid':0x5fd779c,'msg_seq':0xc7a7f60e2d080800,'uin':0x674d9a89},'meta':{'music':{'action':'','android_pkg_name':'','app_type':0x1,'appid':0x5fd779c,'ctime':0x6670467e,'desc':_0x3aee90,'jumpUrl':_0x47337d['VHmQl'](_0x47337d['LAjrs'],_0x379c64)+_0x47337d['oCxIo'],'musicUrl':_0x22132a,'preview':_0x20461c,'cover':_0x20461c,'sourceMsgId':'0','source_icon':'https://p.qpic.cn/qqconnect/0/app_100497308_1626060999/100?max-age=2592000&t=0','source_url':'','tag':_0x17c864(0x1c8),'title':_0xf05a7f,'uin':0x2766}},'prompt':_0x47337d[_0x17c864(0x192)](_0x47337d[_0x17c864(0x182)],_0xf05a7f),'ver':_0x47337d[_0x17c864(0x18f)],'view':_0x17c864(0x1ac)},_0x2fc6c8=await RequestUtil['HttpGetJson'](_0x5b4a5e,_0x47337d[_0x17c864(0x1a6)],_0x53fd9f,{'Cookie':_0x47337d[_0x17c864(0x1b3)],'Content-Type':_0x47337d[_0x17c864(0x184)]});return _0x2fc6c8;}export async function CreateMusicThridWay0(_0x58bc8='',_0x5d5bbe=''){const _0x4555f4=_0x4acc,_0x4552ce={'WALkG':function(_0x421b1e,_0x6d7c66){return _0x421b1e==_0x6d7c66;},'jOBET':function(_0x12b5d5,_0x53b368){return _0x12b5d5+_0x53b368;},'cQkhS':_0x4555f4(0x1c1),'iPtav':_0x4555f4(0x187),'OZZTV':_0x4555f4(0x1d2),'kEjJP':'https://api.leafone.cn/api/qqmusic?id=','yrDov':_0x4555f4(0x18a)};if(_0x4552ce['WALkG'](_0x5d5bbe,'')){let _0x517288=await RequestUtil[_0x4555f4(0x1a0)](_0x4552ce['jOBET'](_0x4552ce['cQkhS'],_0x58bc8)+_0x4552ce['iPtav'],_0x4552ce[_0x4555f4(0x1cf)],undefined);_0x5d5bbe=_0x517288[_0x4555f4(0x19f)]?.['data']?.[_0x4555f4(0x1b5)]['mid'];}let _0x23737f=await RequestUtil['HttpGetJson'](_0x4552ce['jOBET'](_0x4552ce['kEjJP']+_0x5d5bbe,_0x4552ce[_0x4555f4(0x1a2)]),_0x4555f4(0x1d2),undefined);return{..._0x23737f['data'],'mid':_0x5d5bbe};}function _0x1fc1(){const _0x5e7aec=['&type=0','singer','https://h5.qzone.qq.com/v2/vip/tx/trpc/ark-share/GenNewSignedArk?g_tk=','42285cyScdh','skey','source','[分享]','9a63343c32d5a16bcde653eb97faa25d','qoCBl','XTCRY','JYwVP','https://u.y.qq.com/cgi-bin/musicu.fcg?format=json&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq.json&needNewCode=0&data={\x22comm\x22:{\x22ct\x22:24,\x22cv\x22:0},\x22songinfo\x22:{\x22method\x22:\x22get_song_detail_yqq\x22,\x22param\x22:{\x22song_type\x22:0,\x22song_mid\x22:\x22\x22,\x22song_id\x22:','237809XvqEIy','725UtApcK','com.tencent.miniapp.lua','\x5c/\x5c/','ukKMk','preview','QQ音乐','https://ws.stream.qqmusic.qq.com/','10255ouTMzI','miniapp','KMXok','replace','62541wXUyPy','OZZTV','com.tencent.qqreader.share','dKIdp','GET','22534AEPSTD','27762xOlqcf','XttqN','MazHy','uin','p_skey','tag','DUYcp','abhUJ','qtwcC','AKHKR','https://i.y.qq.com/v8/playsong.html?songmid=','},\x22module\x22:\x22music.pf_song_detail_svr\x22}}',';\x20skey=',';\x20uin=o','&type=8','data','ricFf','p_skey=','application/json','FMjsB','jumpUrl','url','VHmQl','unlink','1350aIlWdC','normal','848tDvDKZ','BINBN','mid','83YzAOzZ','nqTJS','POST','BriQO','36158112exntNL','uploadImageForOpenPlatform','songinfo','HttpGetJson','https://mqq.reader.qq.com/api/mqq/share/card?accessToken&_csrfToken&source=c0003','yrDov','CbTRl','&ark=','468pDRmiO','JAyPV','title','signed_ark','prompt','BLtQk','stringify','music','uin=o10086','cover','wqgKi',';\x20p_uin=o','0.0.0.1','FslER','uigGa','HdtBE','track_info'];_0x1fc1=function(){return _0x5e7aec;};return _0x1fc1();}export async function CreateMusicThridWay1(_0x14928f='',_0x4e9dbd=''){}export async function SignMusicWrapper(_0x4f7376=''){const _0x3819b1=_0x4acc,_0x37ec2e={'qoCBl':function(_0x3af4d2,_0x120051){return _0x3af4d2(_0x120051);},'KMXok':function(_0x3d7871,_0x277fa0){return _0x3d7871||_0x277fa0;},'FslER':function(_0x509a9f,_0x1913ba,_0x11512e){return _0x509a9f(_0x1913ba,_0x11512e);},'MvFrl':function(_0x4bf434,_0x31aff7,_0xaad6d3,_0x4202fe,_0x5af4e9,_0x57ba91){return _0x4bf434(_0x31aff7,_0xaad6d3,_0x4202fe,_0x5af4e9,_0x57ba91);},'nqTJS':function(_0x140ae9,_0x4c1f5f){return _0x140ae9+_0x4c1f5f;},'MazHy':_0x3819b1(0x1c9)};let _0x3afc5d=await _0x37ec2e[_0x3819b1(0x1be)](CreateMusicThridWay0,_0x4f7376);const {path:_0x846d27,isLocal:_0x8e5e03,errMsg:_0x224e60}=await _0x37ec2e[_0x3819b1(0x1be)](uri2local,_0x3afc5d[_0x3819b1(0x1ae)]);if(_0x37ec2e[_0x3819b1(0x1cc)](_0x224e60,!_0x846d27))throw'卡片图片不正确';await _0x37ec2e[_0x3819b1(0x1b2)](checkFileReceived2,_0x846d27,0x1388);let _0x11e0b7=await RequestUtil[_0x3819b1(0x19e)](_0x846d27);!_0x8e5e03&&_0xd07c0c[_0x3819b1(0x193)](_0x846d27,()=>{});let _0x428ba7=await _0x37ec2e['MvFrl'](SignMusicInternal,_0x3afc5d['name'],_0x3afc5d[_0x3819b1(0x1b7)],_0x11e0b7,_0x3afc5d[_0x3819b1(0x198)],_0x37ec2e[_0x3819b1(0x19a)](_0x37ec2e[_0x3819b1(0x1d6)],_0x3afc5d[_0x3819b1(0x191)]));return _0x428ba7;}